<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.socket.io/3.1.3/socket.io.min.js"></script>


</head>

<body>
    <div width="400" height="400">
        <canvas id="myChart"></canvas>
    </div>
</body>
<script>
    var time = new Date();
    var currtime = (time.toLocaleString('en-US', {
        hour: 'numeric',
        minute: 'numeric',
        hour12: true
    }));
    var labels = [
        currtime,


    ];
    var data = {
        labels: labels,
        datasets: [{
            label: 'CPU Usage',
            backgroundColor: 'rgb(255, 99, 132)',
            borderColor: 'rgb(255, 99, 132)',
            data: [100, ],
        }]
    };

    var config = {
        type: 'line',
        data,
        options: {}
    };
    var myChart = new Chart(
        document.getElementById('myChart'),
        config
    );
    /*
    var intervalId = window.setInterval(function() {
        console.log(data.datasets[0].data.push(Math.random() * (80 - 1) + 1));
        let time = new Date();
        let currtime = (time.toLocaleString('en-US', {
            hour: 'numeric',
            minute: 'numeric',
            hour12: true
        }));
        labels.push(currtime);
        myChart.update();
    }, 2000); 
    */

    var socket = io();

    socket.emit('request usage', "ping");

    socket.on('response usage', function(msg) {
        console.log("Received usage ->" + msg);
        data.datasets[0].data.push(msg);
        let time = new Date();
        let currtime = (time.toLocaleString('en-US', {
            hour: 'numeric',
            minute: 'numeric',
            hour12: true
        }));
        labels.push(currtime);
        myChart.update();
    });
</script>

</html>